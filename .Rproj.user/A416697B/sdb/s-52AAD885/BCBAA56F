{
    "collab_server" : "",
    "contents" : "---\ntitle       : Análisis de Varianza\nsubtitle    : Diseño de Experimentos    \nauthor      : Carlos Neftaly Lozano A., Msc\nlogo     : EM.png\njob         : www.microbiostats.com\nframework   : io2012        # {io2012, html5slides, shower, dzslides, ...}\nhighlighter : highlight.js  # {highlight.js, prettify, highlight}\nhitheme     : tomorrow      # \nwidgets     : [mathjax, quiz, bootstrap]            # {mathjax, quiz, bootstrap}\nmode        : selfcontained # {standalone, draft}\nlicense     : CC \nknit        : slidify::knit2slides\n---\n\n## Comparando dos grupos... \n```{r Paquetes, include=FALSE}\n library(\"pander\", lib.loc=\"~/R/win-library/3.4\")\nlibrary(car)\n#library(agricolae)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(gridExtra)\n```\n\n```{r, echo=FALSE, fig.align='center', message=FALSE, warning=FALSE}\n\nwdata = data.frame(\n   Cepa = factor(rep(c(\"Pseudomonas sp.\", \"Serratia sp.\"), each=200)),\n   Deg = c(rnorm(200, 52), rnorm(200, 58)))\nggboxplot(wdata, x='Cepa',y='Deg', xlab='Cepa bacteriana',ylab='Concentración (ppm)')\n```\n\n--- \n\n\n\n\n## Introducción\n\n\n```{r, echo=FALSE, fig.align='center'}\nsetwd(\"C:/Users/W/Google Drive/DOE - MIA/2017-2/Slides/Rmarkdown/ANOVA/assets/data\")\ndat_Camp1<-read.csv('2017-02-22 Datos variables campo ciclo 1 (David A).csv',sep=';')\n\ndatCampc1<-tbl_df(dat_Camp1)\ndatCamC1<- group_by(datCampc1, Bloque,Tratamiento)\n\ndatCamp1<-summarize(datCamC1, count = n(), Tallos = mean(Tallos, na.rm = T), Dtallos = mean(D_tallo, na.rm = T), Flores=mean(Flores, na.rm = T), D_flor=mean(D_flor, na.rm = T), L_ped=mean(L_ped, na.rm = T),\n                    Peso=mean(Peso, na.rm = T), Puntos=mean(Puntos, na.rm = T), L_tallo=mean(L_tallo, na.rm = T))\n\ndatCamp1$Tratamiento <- factor(datCamp1$Tratamiento,\n                                levels=c('Nada','Hongos','Solarizada','Basamid'))\n\n\n\n\n## Ciclo 1 \n### Tallos \nggplot(datCamp1, aes(Tratamiento, Tallos)) + \n  geom_boxplot(aes(fill = Tratamiento))  + \n  geom_jitter(position = position_jitter(width = .15), alpha=0.3, size=2) +\n  xlab(\"Tratamiento\") +\n  ylab(\"Log(UFC/g)\") +theme_bw() + theme(legend.position = \"none\",axis.title.x=element_text(size = 22), \n                                     axis.title.y = element_text(size = 22))\n```\n\n---\n\n## ANOVA unifactorial o de una vía \n\n\n```{r, echo=FALSE,fig.align='center'}\n      knitr::include_graphics('./assets/img/poblaciones.png')\n```\n\n---\n\n\n## ANOVA unifactorial: Cuantitativa vs. categórica\n\n Se refiere a una clase de muestreo o diseños experimentales, en los   cuales la variable __predictora__ o __explicativa__ es   _categórica_ y la variable __respuesta__ es  __continua__.\n\n```{r, echo=FALSE, fig.align='center', fig.height=6}\n## Ciclo 1 \n### Tallos \nggplot(datCamp1, aes(Tratamiento, Tallos)) + \n  geom_boxplot(aes(fill = Tratamiento))  + \n  geom_jitter(position = position_jitter(width = .15), alpha=0.3, size=2) +\n  xlab(\"Tratamiento\") +\n  ylab(\"Log(UFC/g)\") +theme_bw() + theme(legend.position = \"none\",axis.title.x=element_text(size = 22), \n                                     axis.title.y = element_text(size = 22))\n```\n\n---\n\n## ANOVA unifactorial \n\nSe fundamenta en la descomposición de la variación de una variable _respuesta_ $\\bar{Y}$, entre la varainza explicada  y no   explicada por uno o varios factores.\n \n <span style=\"display:block; height: 2cm;\"></span>\n \n```{r, echo=FALSE,fig.align='center'}\n      knitr::include_graphics('./assets/img/anova_des.png')\n```\n\n---\n\n## ANOVA unifactorial: Objetivo\n\n<span style=\"display:block; height: 2cm;\"></span>\nEl `ANOVA` tiene como objetivos centrales:\n\n\n+ Examinar la contribución relativa de cada una de las fuentes de variación, a la variabilidad total de $\\bar{y}$.\n\n+ Probar la hipótesis nula $(H_0)$, que la __media__ de los grupos o tratamientos son iguales. \n\n---\n\n## ANOVA: Una perspectiva gráfica\nCuando analizamos los datos usando análisis de varianza, el primer paso\nes poner a prueba la hipótesis nula global:\n\n\\[ H_0: \\mu_1 = \\mu_2 = \\mu_3= .. \\mu_I\\] contra\n\n\n\\[ H_a: \\text{al menos una media difiere} \\]\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center',fig.height=4}\nwdata = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=7)),\n  UFC = c(rnorm(7, 5.2), rnorm(7, 5), rnorm(7, 5), rnorm(7, 5)))\n\nggdotplot(wdata, x='Tratamiento',y='UFC', xlab='Tratamiento',ylab='Log(UFC/g)', add='mean', color='Tratamiento')\n```\n\n\n---\n\n## ANOVA\n\n> +  Comparamos la variación __dentro de cada grupo__ con la obtenidad __entre cada grupo__ para evaluar si existen diferencias significativas en las medias poblacionales. \n\n<span style=\"display:block; height: 2cm;\"></span>\n\n> + Por lo tanto, al comparar estas dos medidas de varianza entre sí, podemos detectar si hay verdaderas diferencias entre las medias de la población. \n\n\n---\n\n\n## ANOVA: Comparando varianzas\n\nSi la varianza __entre grupos__ es similar a la __dentro__ de los grupos: \n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}\nwdata3 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=10)),\n  UFC = c(rnorm(10, 4), rnorm(10, 4), rnorm(10, 4), rnorm(10, 4)))\n\n\n\n\nggdotplot(wdata3, x = \"Tratamiento\", y='UFC',\n            add = \"mean\", rug = TRUE,\n            fill = \"Tratamiento\",\n             xlab = 'UFC/g', ylab = 'UFC/g')\n```\n\n\n---\n\n## ANOVA: Comparando varianzas\n\nSi la varianza __entre grupos__ es similar a la __dentro__ de los grupos: \n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}\nwdata3 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 4), rnorm(200, 4), rnorm(200, 4)))\n\n\n\n\ngghistogram(wdata3, x = \"UFC\",\n            add = \"mean\", rug = TRUE,\n            fill = \"Tratamiento\",\n            add_density = TRUE, xlab = 'UFC/g', ylab = 'Frecuencia')\n```\n\n\n---\n\n## ANOVA: Comparando varianzas\n\nSi la varianza __entre grupos__ es mucho mayor que la __dentro__ de los grupos: \n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}\nwdata2 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=6)),\n  UFC = c(rnorm(6, 4), rnorm(6, 8), rnorm(6, 4), rnorm(6, 3.5)))\n\nggdotplot(wdata2, x='Tratamiento',y='UFC', xlab='Tratamiento',ylab='Log(UFC/g)', add='mean', color='Tratamiento')\n\n\n```\n\n\n---\n\n## ANOVA: Comparando varianzas\n\nSi la varianza __entre grupos__ es mucho mayor que la __dentro__ de los grupos: \n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}\nwdata2 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 8), rnorm(200, 4), rnorm(200, 4)))\n\n\n\n\ngghistogram(wdata2, x = \"UFC\",\n            add = \"mean\", rug = TRUE,\n            fill = \"Tratamiento\",\n            add_density = TRUE, xlab = 'Tratamiento', ylab = 'Frecuencia')\n```\n\n---\n\n\n## ANOVA: Particionando la varianza.... \n\nEl ANOVA está construido sobre el concepto de partición de la\n__suma de cuadrados__. La variación total en un conjunto de datos\npuede ser expresada como suma de cuadarados __(SS)__: La diferencia\nentre cada observación $(Y_i)$ y la gran media de los datos ($\\bar{Y}$)\nelevado al cuadrado y sumado.\n\n\n\n\\[\\underbrace{Y_{ij}}_{Respuesta} = \\underbrace{\\bar{\\mu}}_{\\text{Media global}} + \\underbrace{\\tau_i}_{\\text{Efecto del tto}} + \\underbrace{e_{ij}}_{\\text{Error aleatorio}} \\]\n\n<span style=\"display:block; height: 3cm;\"></span>\n\n\\[ SS_{total}= SS_{factor}+ SS_{error} \\]\n\n---\n\n## Notación.... \n\n  \n  + $N$: número total de observaciones.\n  + $i$: número de grupos.\n  + $\\bar{y}$: media general 'gran media'.\n  \nCada grupo $i$ tiene: \n  \n  + $n_i$: número de observaciones en el grupo $i$.\n  + $y_{ij}$ = observación $j$ en el grupo $i$.\n  +  $\\bar{y}_i$: media del grupo $i$.\n  + $s_i$: Desviación de estándar en el grupo $i$.\n\n---\n\n## ANOVA: Suma de cuadrados totales\n\n\n\n\\[SS_{total}=\\sum_{i=1}^{a} \\sum_{j=1}^{n} (Y_{ij} - \\bar{Y})^2 \\]\n\n  <span style=\"display:block; height: 2cm;\"></span>\nSiendo, \n $i$ = 1 hasta __a__ tratamientos ; $j$= 1 hasta __n__ réplicas.\n \n  <span style=\"display:block; height: 2cm;\"></span>\n> Refleja la desviación de cada observación de la 'gran media'.\n\n---\n\n## ANOVA: Suma de cuadrados entre grupos \n\n\\[SS_{factor}=\\sum_{i=1}^{a} \\sum_{j=1}^{n} (\\bar{Y}_{i} - \\bar{Y})^2 \\]\n\n\n\n```{r, echo=FALSE,fig.align='center', fig.height=2}\n      knitr::include_graphics('./assets/img/betw.png')\n```\n\n> Representa la diferencia entre las medias de cada grupo o tratamiento con respcto a la media global.\n\n---\n\n## ANOVA: Suma de cuadrados dentro de grupos \n\n\\[SS_{error}=\\sum_{i=1}^{a} \\sum_{j=1}^{n} (\\bar{Y_{ij}} - \\bar{Y_i})^2 \\]\n\n```{r, echo=FALSE,fig.align='center', fig.height=2}\n      knitr::include_graphics('./assets/img/into.png')\n```\n\n> Representa el error aleatorio o variación residual.\n\n---\n\n## ANOVA: Tabla ANOVA\n\n  <span style=\"display:block; height: 4cm;\"></span>\n```{r, echo=FALSE,fig.align='center', fig.height=3}\n      knitr::include_graphics('./assets/img/anova.png')\n```\n\n---\n\n## ANOVA: Tabla ANOVA\n\n  <span style=\"display:block; height: 4cm;\"></span>\n```{r, echo=FALSE,fig.align='center'}\nlibrary(xtable)\n      wdata2 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 8), rnorm(200, 4), rnorm(200, 4)))\n\nkable(anova(mod<-lm(UFC~Tratamiento, data=wdata2)), digits = 3)\n```\n\n---\n\n## Comprobando Supuestos: Normalidad  \n\nSuponemos que los __errores__ y __las observaciones__, \ndentro de cada grupo provienen de  poblaciones con distribución normal. \n\n<span style=\"display:block; height: 1cm;\"></span>\n     \t \t \n> \\[H_o: \\text{Los residuales están normalmente distribuidos.} \\]\n\n<span style=\"display:block; height: 1cm;\"></span>\n\n\t\t\n> \\[H_a: \\text{Los residuales no  están normalmente distribuidos.} \\]\n\n<span style=\"display:block; height: 1cm;\"></span> \n\n>La idea es no rechazar $H_o$ para asegurar el cumplimiento del supuesto.\n\n---\n\n## Normalidad: Validación gráfica mediante histogramas\n\nLos histogramas, de forma, exploratoria nos permite determinar _simetría_ y \n_modalidad_ en nuestros datos.\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center', fig.width=14, fig.height=5}\nwdata2 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 8), rnorm(200, 4), rnorm(200, 3.5)))\n\n\ndvpl<-gghistogram(wdata2, x = \"UFC\",\n            add = \"mean\",\n            \n            add_density = TRUE) \n\n\n\n\n\nnorm<-data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 4), rnorm(200, 4), rnorm(200, 4)))\nnopl<-gghistogram(norm, x = \"UFC\",\n            add = \"mean\", add_density = T\n            \n            ) \n\n\nggarrange(nopl, dvpl,\n          ncol = 2, nrow = 1)\n```\n\n---\n\n## Normalidad: Validación gráfica mediante Q-Q plot\nLos gráficos __cuantil-cuantil__ o __QQ plot__, nos permite contrastar nuestros datos con una distribución normal teórica.\n\n```{r, echo=FALSE,fig.align='center', fig.width=14, fig.height=3}\n      knitr::include_graphics('./assets/img/qqnorm.png')\n```\n\n\n---\n\n## Normalidad: Validación gráfica mediante Q-Q plot\nLos gráficos __cuantil-cuantil__ o __QQ plot__, nos permite contrastar nuestros datos con una distribución normal teórica.\n\n```{r, echo=FALSE,fig.align='center', fig.width=14, fig.height=3}\n      knitr::include_graphics('./assets/img/qqnormNO.png')\n```\n\n\n---\n\n## Normalidad: Validación mediante Pruebas\n\n + Shapiro - Wilks  - `shapiro.test()`\n```{r}\n\nresiduos<-rnorm(100, mean = 5, sd = 3)\nshapiro.test(residuos)\n```\n\n\n---\n\n## Comprobando Supuestos: Homocedasticidad\n\nAsumen que la varianza en la variable respuesta es la misma \nen cada nivel, o combinación de los niveles del factor o factores.\n\n> \\[H_o: \\text{La varianza de $Y$ es igual en cada nivel del factor} \\]\n\n<span style=\"display:block; height: 1cm;\"></span>\n\n\t\t\n> \\[H_a: \\text{La varianza de $Y$ no es igual en cada nivel del factor.} \\]\n\n<span style=\"display:block; height: 1cm;\"></span> \n\n>La idea es no rechazar $H_o$ para asegurar el cumplimiento del supuesto.\n\n---\n\n\n## Homocedasticidad: Validación gráfica mediante Box-plot\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}\n\nwdata2 = data.frame(\n  Tratamiento = factor(rep(c(\"Nada\", \"Hongos\", 'Solarizada', 'Basamid'), each=200)),\n  UFC = c(rnorm(200, 4), rnorm(200, 8), rnorm(200, 4), rnorm(200, 3.5)))\nggplot(wdata2, aes(Tratamiento, UFC)) + \n  geom_boxplot(aes(fill = Tratamiento))  + \n  geom_jitter(position = position_jitter(width = .15), alpha=0.3, size=2) +\n  xlab(\"Tratamiento\") +\n  ylab(\"Log(UFC/g)\") +theme_bw() + theme(legend.position = \"none\",axis.title.x=element_text(size = 22), \n                                     axis.title.y = element_text(size = 22))\n```\n\n---\n\n## Homocedasticidad: Validación gráfica model-plot\n\n```{r, echo=FALSE,fig.align='center', fig.width=14, fig.height=3}\n      knitr::include_graphics('./assets/img/homoced.png')\n```\n\n---\n\n## Homocedasticidad: Validación mediante pruebas \n### Prueba de Bartlett - `bartlett.test()`\n \n```{r, echo=FALSE, message=FALSE, warning=FALSE}\n\nbartlett.test(count ~ spray, data = InsectSprays)\n\nwith(Moore, leveneTest(conformity, fcategory))\nwith(Moore, leveneTest(conformity, interaction(fcategory, partner.status)))\nbartlett.test(conformity ~ fcategory, data=Moore)\n```\n\n---\n\n\n## Homocedasticidad: Validación mediante pruebas \n### Prueba de Levene - `LeveneTest()`\n \n```{r, echo=FALSE, message=FALSE, warning=FALSE}\n\nwith(Moore, leveneTest(conformity, fcategory))\nwith(Moore, leveneTest(conformity, interaction(fcategory, partner.status)))\nleveneTest(conformity ~ fcategory*partner.status, data=Moore)\n\n```\n\n---\n\n## Padoc\n\n---",
    "created" : 1505190422713.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1119180699",
    "id" : "BCBAA56F",
    "lastKnownWriteTime" : 1505235349,
    "last_content_update" : 1505235349658,
    "path" : "C:/Users/W/Google Drive/DOE - MIA/2017-2/Slides/Rmarkdown/ANOVA/index.Rmd",
    "project_path" : "index.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}